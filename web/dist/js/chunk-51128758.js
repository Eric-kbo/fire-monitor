(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-51128758"],{5425:function(t,s,e){},9041:function(t,s,e){"use strict";e.r(s);var a={data:()=>({date:(new Date).toISOString().slice(0,10),zoom:8,show:!1,list:[],current:0,currentMark:0,center:"长沙"}),watch:{current(t){this.$nextTick(()=>{this.center={lng:this.list[t].lng,lat:this.list[t].lat},this.infoWindowOpen(t)})}},mounted(){setTimeout(()=>{this.infoWindowOpen(0)},0)},methods:{onReady({BMap:t,map:s}){this.getData()},async getData(){this.date="2020-12-03";let t=(await this.$chntek.transWarningList(this.date)).map(t=>t.id).join(","),s=await this.$chntek.devices.statusHistory(t,this.date),e=Object.keys(s).filter(t=>s[t]!=[]&&s[t][0].longitude&&s[t][0].longitude);this.list=e.map(t=>({id:t,hydraulic_pressure:s[t][0].hydraulic_pressure,temperature:s[t][0].temperature,energy:s[t][0].energy,time:s[t][0].time,longitude:s[t][0].longitude,latitude:s[t][0].latitude,lng:s[t][0].longitude.slice(1),lat:s[t][0].latitude.slice(1)})),this.center=this.list[0]},infoWindowOpen(t){this.currentMark=t,this.show=!0},infoWindowClose(){this.show=!1}}},i=(e("a66d"),e("2877")),n=Object(i.a)(a,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"map-container"},[e("baidu-map",{staticClass:"map",attrs:{center:t.center,zoom:t.zoom},on:{ready:t.onReady}},[e("bm-control",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_LEFT"}},[e("md-field",{staticClass:"select-address",attrs:{validity:""}},[e("label",{attrs:{for:"address"}},[t._v("选择一个地点")]),e("md-select",{key:"adress",attrs:{name:"address",id:"address"},model:{value:t.current,callback:function(s){t.current=s},expression:"current"}},t._l(t.list,(function(s,a){return e("md-option",{key:a,attrs:{value:a}},[t._v(t._s(s.id))])})),1)],1)],1),e("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT"}}),t._l(t.list,(function(s,a){return e("bm-marker",{key:s.id,attrs:{position:{lng:s.lng,lat:s.lat},dragging:!1,offset:{width:0,height:0}},on:{click:function(s){return t.infoWindowOpen(a)}}})})),t._l(t.list,(function(s,a){return e("bm-info-window",{key:a,staticClass:"message-box",attrs:{show:t.show&&t.currentMark==a,width:220,closeOnClick:!0,offset:{width:0,height:0},position:{lng:s.lng,lat:s.lat}},on:{close:t.infoWindowClose}},[e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("设备名称:")]),t._v(" 编号"+t._s(s.id)+" ")]),e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("当前水压:")]),t._v(" "+t._s(s.hydraulic_pressure)+" ")]),e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("当前温度:")]),t._v(" "+t._s(s.temperature)+" ")]),e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("当前电量:")]),t._v(" "+t._s(s.energy)+" ")]),e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("时间")]),t._v(" "+t._s(s.time)+" ")]),e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("经度")]),t._v(" "+t._s(s.longitude)+" ")]),e("p",{staticClass:"display-flex message"},[e("span",{staticClass:"flex_1"},[t._v("纬度")]),t._v(" "+t._s(s.latitude)+" ")])])}))],2)],1)}),[],!1,null,"0f4587b1",null);s.default=n.exports},a66d:function(t,s,e){"use strict";e("5425")}}]);