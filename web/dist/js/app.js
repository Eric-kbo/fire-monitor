(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("db4d");var n=a("2b0e"),i={name:"headbarVue",props:{model:{type:[Object]}},methods:{menuChange(){this.model.menuVisible=!this.model.menuVisible},goto(t){this.$route.name!=t&&this.$router.replace({name:t})}}},s=(a("a204"),a("2877")),o=Object(s.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["detail"!=t.$route.name?n("div",{staticClass:"md-toolbar-section-start"},[n("img",{attrs:{src:a("9d64")}}),n("span",{staticClass:"md-title"},[t._v("启泰传感")])]):n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"back-button",on:{click:function(e){return t.goto("warn")}}},[n("md-icon",{staticClass:"iconfont iconfanhui"})],1),n("span",{staticClass:"location"},[t._v(t._s(t.$route.params.location?t.$route.params.location:"未获取到地点"))])],1)])}),[],!1,null,"a227e280",null).exports,r={name:"tabbarVue",data:()=>({}),methods:{goto(t){this.$route.name!=t&&this.$router.replace({name:t})}}},c=(a("687d"),Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("md-bottom-bar",{staticClass:"tabbar"},[a("md-bottom-bar-item",{class:"home"==t.$route.name?"active":"default",on:{click:function(e){return t.goto("home")}}},[a("i",{staticClass:"tabbaricon iconfont iconxianshi2"}),a("p",[t._v("综合显示")])]),a("md-bottom-bar-item",{class:"gmap"==t.$route.name?"active":"default",on:{click:function(e){return t.goto("gmap")}}},[a("i",{staticClass:"tabbaricon iconfont iconditu1"}),a("p",[t._v("GIS模块")])]),a("md-bottom-bar-item",{class:"warn"==t.$route.name?"active":"default",on:{click:function(e){return t.goto("warn")}}},[a("i",{staticClass:"tabbaricon iconfont iconjinggao1"}),a("p",[t._v("告警列表")])]),a("md-bottom-bar-item",{class:"data"==t.$route.name?"active":"default",on:{click:function(e){return t.goto("data")}}},[a("i",{staticClass:"tabbaricon iconfont iconshujuzhongxin"}),a("p",[t._v("数据中心")])])],1)}),[],!1,null,"3c62cf36",null).exports),l={name:"sidebarVue",methods:{goto(t){this.$emit("change"),this.$route.name!=t&&this.$router.replace({name:t})}}},u=(a("f933"),{name:"App",data:()=>({menuVisible:!1}),components:{headbarVue:o,tabbarVue:c,sidebarVue:Object(s.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sidebar"},[n("md-toolbar",{staticClass:"md-transparent",attrs:{"md-elevation":"0"}},[n("img",{attrs:{src:a("9d64")}})]),n("md-list",[n("md-list-item",{staticClass:"route",class:"home"==t.$route.name?"active":""},[n("md-icon",{staticClass:"tabbaricon iconfont iconxianshi2"}),n("span",{attrs:{id:"home"},on:{click:function(e){return t.goto("home")}}},[t._v("综合显示")])],1),n("md-list-item",{staticClass:"route",class:"gmap"==t.$route.name?"active":""},[n("md-icon",{staticClass:"tabbaricon iconfont iconditu1"}),n("span",{attrs:{id:"gmap"},on:{click:function(e){return t.goto("gmap")}}},[t._v("GIS模块")])],1),n("md-list-item",{staticClass:"route",class:"warn"==t.$route.name?"active":""},[n("md-icon",{staticClass:"tabbaricon iconfont iconjinggao1"}),n("span",{attrs:{id:"alert"},on:{click:function(e){return t.goto("warn")}}},[t._v("告警列表")])],1),n("md-list-item",{staticClass:"route",class:"data"==t.$route.name?"active":""},[n("md-icon",{staticClass:"tabbaricon iconfont iconshujuzhongxin"}),n("span",{attrs:{id:"data"},on:{click:function(e){return t.goto("data")}}},[t._v("数据中心")])],1)],1)],1)}),[],!1,null,"c76d6fd4",null).exports},methods:{menuChange(){this.menuVisible=!this.menuVisible}}}),d=(a("fc44"),Object(s.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("md-app",{attrs:{"md-mode":"fixed"}},[a("md-app-toolbar",{staticClass:"md-primary header display-flex"},[a("headbar-vue"),a("div",{staticClass:"md-toolbar-section-end"},[a("md-button",{staticClass:"md-icon-button",on:{click:function(e){return t.menuChange()}}},[a("md-icon",{staticClass:"iconfont iconmenu-fill"})],1)],1)],1),a("md-app-drawer",{attrs:{"md-active":t.menuVisible,"md-right":!0},on:{"update:mdActive":function(e){t.menuVisible=e},"update:md-active":function(e){t.menuVisible=e}}},[a("sidebar-vue",{on:{change:function(e){return t.menuChange()}}})],1),a("md-app-content",[a("keep-alive",[a("router-view",{staticClass:"view"})],1)],1)],1),a("tabbar-vue",{staticClass:"tabbar"})],1)}),[],!1,null,"132ca5f6",null).exports),m=(a("82da"),a("ae17"),a("43f9")),p=a.n(m),f=(a("43f4"),a("313e")),h=a.n(f);const b=a("bc3a"),g="http://iot.chntek.com:3410";const v=new function(){this.devices={async deviceIds(){const{data:t}=await b.get(g+"/api/Terminal/GetAllDevice",{headers:{Authorization:"12"}});if(t.Err)throw t.Err;if(t.err)throw t.err;return console.log(t.val),t.val},async statusHistory(t){if(""==t.trim()){let t=await this.deviceIds();for(let e of t);}let e=(new Date).toLocaleDateString().replace(new RegExp("/","g"),"-");const{data:a}=await b.get(g+"/api/Terminal/HistoryData",{params:""==t.trim()?{searchDate:e}:{searchDate:e,ids:t},headers:{Authorization:"12"}});if(a.err)throw a.err;let n={};for(let t in a.val){let e=a.val[t];n[t]=[];for(let a of e)n[t].push({hydraulic_pressure:a.pressure,temperature:a.temper,energy:a.electricity,signal_intensity:a.rssi,status_of_low_hydraulic_pressure:0,status_of_high_hydraulic_pressure:0,status_of_leak:0,status_of_low_temperature:0,status_of_high_temperature:0,status_of_slope:0,status_of_vibration:0,status_of_energy:0,status_of_pressure_sensor:0,status_of_water_quality:0,status_of_subzero_temperature:0,status_of_low_signal_intensity:0,longitude:a.longitude,latitude:a.latitude,time:a.monitorsTime})}return n},async warningList(t){const{data:e}=await b.get(g+"/api/Terminal/RealTimeData",{params:{searchDate:t},headers:{Authorization:"12"}});if(e.Err)throw e.Err;if(e.err)throw e.err;let a=[];for(let t of e.val)a.push({id:t.terminalNum,location:t.prefecturecity+t.distriancounty+t.customerunit,warning_type:t.warnName,time:t.monitorsTime});return console.log(a),a},async warningStatistics(t,e,a){const{data:n}=await b.get(g+"/api/Terminal/WarningList",{params:{date_begin:e,date_end:a,ids:t},headers:{Authorization:"12"}});if(n.err)throw n.err;return n.val}},this.transDeviceStatus=async t=>{let e=await this.devices.statusHistory(t),a=[],n=["00","01","02","03","04","05","06","07","08","09","10","11","12","14","15","16","17","18","19","20","21","22","23"],i=[],s=[],o=[];for(let t in e){let n=e[t];a.push(t);let r={name:t,type:"line",data:[]},c={name:t,type:"line",data:[]},l={name:t,type:"line",data:[]};for(let t=0,e=0,a=0,i=100;t<24;t++){for(let a of n){if(t==new Date(a.time).getHours()){e=a.hydraulic_pressure,i=a.energy;break}}r.data.push(e),c.data.push(a),l.data.push(i)}i.push(r),s.push(c),o.push(l)}let r=[{title:{text:"压力"},legend:{data:a},xAxis:{data:n},series:i},{title:{text:"温度"},legend:{data:a},xAxis:{data:n},series:s},{title:{text:"电量"},legend:{data:a},xAxis:{data:n},series:o}];return console.log(r),r},this.transWarningListOfToday=async()=>{let t=new Date,e=t.getMonth()+1,a=t.getDay()+1;e=e<10?"0"+e:e,a=a<10?"0"+a:a;let n=`${t.getFullYear()}-${e}-${a}`,i=await this.devices.warningList(n),s=[];for(let e of i){let a=new Date(e.time);t.toLocaleDateString()==a.toLocaleDateString()&&s.push(e)}return console.log(s),s},this.transWarningListOfMonths=async t=>{let e=await this.devices.warningList(t),a=new Date,n=[];for(let t of e){let e=new Date(t.time);a.toLocaleDateString()!==e.toLocaleDateString()&&n.push(t)}return console.log(n),n},this.transStatistics=async(t,e,a)=>{let n=await this.devices.warningStatistics(t,e,a),i=[],s=[],o=[];for(let t in n){let e=n[t];for(let t in e)-1==s.indexOf(t)&&s.push(t)}s.sort((t,e)=>Date.parse(t)-Date.parse(e));for(let t in n){let e=n[t];i.push(t);let a={name:t,type:"line",data:[]};for(let t of s){let n=e[t];a.data.push(n||0)}o.push(a)}return[{title:{text:"统计"},legend:{data:i},xAxis:{data:s},series:o}]}};var w=v;try{document.addEventListener("deviceready",async()=>{window.cordova.plugins.backgroundode.enable(),setInterval(async()=>{let t=window.localStorage.getItem("warningsLength"),e=await v.transWarningListOfToday();e==t&&window.cordova.plugins.notification.local.schedule({test:"有新的告警信息！"}),window.localStorage.setItem("warningsLength",e.length)},6e4)})}catch(t){console.error(t)}var _=a("8c4f");n.default.use(_.a);const y=[{path:"*",redirect:{name:"home"}},{name:"home",component:()=>a.e("chunk-f008a43e").then(a.bind(null,"6511"))},{name:"gmap",component:()=>a.e("chunk-61c7cdd9").then(a.bind(null,"9041"))},{name:"warn",component:()=>a.e("chunk-c9890114").then(a.bind(null,"bbe2"))},{name:"data",component:()=>a.e("chunk-4553a56a").then(a.bind(null,"fad0"))},{name:"detail",component:()=>a.e("chunk-eaf17f58").then(a.bind(null,"1000"))}];y.forEach(t=>{t.path=t.path||"/"+t.name||""});const C=new _.a({mode:"history",base:function(){let t=location.pathname;return t.substring(0,t.lastIndexOf("/")+1)}(),routes:y});C.afterEach(()=>{window.scrollTo(0,0)});var x=C,$=a("bd0c"),k=a.n($);n.default.use(p.a),n.default.prototype.$echarts=h.a,n.default.prototype.$chntek=w,n.default.use(k.a,{ak:"aczIoSxQtHDKl7gLRKWxySCwKOvzXq3u"}),n.default.config.productionTip=!1,new n.default({router:x,render:t=>t(d)}).$mount("#app")},"687d":function(t,e,a){"use strict";a("933b")},"82da":function(t,e,a){},"933b":function(t,e,a){},"93f9":function(t,e,a){},"9d64":function(t,e,a){t.exports=a.p+"img/logo.png"},a204:function(t,e,a){"use strict";a("b0db")},ae17:function(t,e,a){},b0db:function(t,e,a){},ed6c:function(t,e,a){},f933:function(t,e,a){"use strict";a("ed6c")},fc44:function(t,e,a){"use strict";a("93f9")}},[[0,"runtime","npm.echarts","npm.babel-polyfill","npm.zrender","npm.vue-material","npm.vue-baidu-map","npm.vue","vendors~app"]]]);